/*!
 * 
 *     iclient9-mapboxgl.(http://iclient.supermapol.com)
 *     CopyrightÂ© 2000-2017 SuperMap Software Co. Ltd
 *     license: Apache-2.0
 *     version: v9.0.0
 * 
 */
!function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=function t(e,n,o){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in a)return a.value;var r=a.get;if(void 0!==r)return r.call(o)},c={};try{c=n(3)}catch(t){c={}}try{n(2)}catch(t){({})}var u=c.baiduMapLayer?c.baiduMapLayer.__proto__:Function,v=function(t){function e(t,n,i,r){if(o(this,e),!u)return a(s);var s=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r));s.map=t;var c=s;return r=r||{},c.init(r),c.argCheck(r),s.canvasLayer=n,s.clickEvent=s.clickEvent.bind(s),s.mousemoveEvent=s.mousemoveEvent.bind(s),s.map.on("move",s.moveEvent.bind(s)),s.map.on("moveend",s.moveEndEvent.bind(s)),s.map.on("remove",s.removeEvent.bind(s)),s.bindEvent(),s}return i(e,u),r(e,[{key:"clickEvent",value:function(t){var n=t.layerPoint;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,n,t)}},{key:"mousemoveEvent",value:function(t){var n=t.layerPoint;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"bindEvent",value:function(t){var e=this.map;this.options.methods&&(this.options.methods.click&&e.on("click",this.clickEvent),this.options.methods.mousemove&&e.on("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(t){var e=this.map;this.options.methods&&(this.options.methods.click&&e.off("click",this.clickEvent),this.options.methods.mousemove&&e.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"updateData",value:function(t,e){t&&t.get&&this.dataSet.set(t.get()),this.update({options:e})}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var e=this,n=e.options.animation,o=this.getContext(),a=this.map;if(e.isEnabledTime()){if(void 0===t)return void this.clear(o);"2d"===this.context&&(o.save(),o.globalCompositeOperation="destination-out",o.fillStyle="rgba(0, 0, 0, .1)",o.fillRect(0,0,o.canvas.width,o.canvas.height),o.restore())}else this.clear(o);if("2d"===this.context)for(var i in e.options)o[i]=e.options[i];else o.clear(o.COLOR_BUFFER_BIT);if(!(e.options.minZoom&&a.getZoom()<e.options.minZoom||e.options.maxZoom&&a.getZoom()>e.options.maxZoom)){var r={transferCoordinate:function(t){var e=a.project(new window.mapboxgl.LngLat(t[0],t[1]));return[e.x,e.y]}};void 0!==t&&(r.filter=function(e){var o=n.trails||10;return t&&e.time>t-o&&e.time<t});var s=e.dataSet.get(r);this.processData(s),e.options._size=e.options.size;var u=a.project(new window.mapboxgl.LngLat(0,0));this.drawContext(o,new c.DataSet(s),e.options,u),e.options.updateCallback&&e.options.updateCallback(t)}}}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){}},{key:"removeEvent",value:function(){this.canvasLayer.mapContainer.removeChild(this.canvasLayer.canvas)}},{key:"moveEvent",value:function(){this._hide()}},{key:"moveEndEvent",value:function(){this._canvasUpdate(),this._show()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"_hide",value:function(){this.canvasLayer.canvas.style.display="none"}},{key:"_show",value:function(){this.canvasLayer.canvas.style.display="block"}},{key:"draw",value:function(){this.canvasLayer.draw()}}]),e}();t.exports=v},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=n(0),r=function(){function t(e,n,a){o(this,t),this.map=e,this.mapvLayer=new i(e,this,n,a),this.canvas=this._createCanvas(),this.mapvLayer._canvasUpdate(),this.mapContainer=e.getCanvasContainer(),this.mapContainer.appendChild(this.canvas)}return a(t,[{key:"getTopLeft",value:function(){var t,e=this.map;return e&&(t=e.getBounds().getNorthWest()),t}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.getCanvas().style.width),t.height=parseInt(this.map.getCanvas().style.height),t.style.width=this.map.getCanvas().style.width,t.style.height=this.map.getCanvas().style.height,t}}]),t}();window.mapvlayer=r,t.exports=r},function(t,e){if(typeof mapbox-gl==="undefined"){var n=new Error('Cannot find module "mapbox-gl"');throw n.code="MODULE_NOT_FOUND",n}t.exports=mapbox-gl},function(t,e){if("undefined"==typeof mapv){var n=new Error('Cannot find module "mapv"');throw n.code="MODULE_NOT_FOUND",n}t.exports=mapv}]);
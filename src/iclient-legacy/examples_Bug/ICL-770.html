<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>矢量图层选择事件</title>
    <style type="text/css">
        body{
            margin: 0;
            overflow: hidden;
            background: #fff;
        }
        #map{
            position: relative;
            height: 520px;
            border:1px solid #3473b7;
        }

        #toolbar {
            position: relative;
            padding-top: 5px;
            padding-bottom: 10px;
        }
    </style>
    <script src = '../libs/SuperMap.Include.js'></script>
	<script src = 'js/jquery.js'></script>
    <script type="text/javascript">
        var map,
			layer,
			vectorlayer,
			pointFeature,
			dragFeature,
			selectFeature,
			navi,
			i,
			url ="http://localhost:8090/iserver/services/map-world/rest/maps/World";
        function init()
        {
            map = new SuperMap.Map("map",{controls:[
                new SuperMap.Control.Zoom(),
                new SuperMap.Control.LayerSwitcher()
            ]});
            layer = new SuperMap.Layer.TiledDynamicRESTLayer("World", url, null, {maxResolution: "auto"});
            layer.events.on({"layerInitialized": addLayer});
            vectorlayer= new SuperMap.Layer.Vector("vectorLayer", {renderers: ["Canvas"]});
			addData();
			navi = new SuperMap.Control.Navigation();
			map.addControl(navi);
			i = 0;
			navi.deactivate();

            var callbacks={
                click: function(){
						   if(i == 0){
                               navi.activate();
                               //始终保证选择控件在漫游控件之后激活。（ICL770的绕开问题的办法）
                               this.deactivate();
                               this.activate();
                           }
                           i = 1;
                           console.log(11);
				       }
            };
            selectFeature = new SuperMap.Control.SelectFeature(vectorlayer, {
			    callbacks: callbacks,
                //onSelect: onFeatureSelected,
				hover: false
			});
           /* function onFeatureSelected(currentFeature){
                if(i == 0){
                    navi.activate();
                }
                console.log("123");
                i = 1;   
            }*/
            map.addControl(selectFeature);			
            selectFeature.activate();

			
        }

        function addLayer(){

            map.addLayers([layer,vectorlayer]);
            //显示地图范围
            map.setCenter(new SuperMap.LonLat(0, 0 ), 0);
        }
        var  infowin=null;

        function closeInfoWin(){
            if(infowin){
                try{
                    infowin.hide();
                    infowin.destroy();
                }
                catch(e){}
            }
        }
        function addData(){
            vectorlayer.removeAllFeatures();
            var point= new SuperMap.Geometry.Point(0,0);
            pointFeature = new SuperMap.Feature.Vector(point);
            pointFeature.style={
                fillColor:"red",
                strokeColor:"yellow",
                pointRadius:7
            };
            vectorlayer.addFeatures(pointFeature);
        }


    </script>
</head>
<body onload="init()" >
<div id="toolbar">
</div>
<div id="map"></div>

</body>
</html>
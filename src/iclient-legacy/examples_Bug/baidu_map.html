<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>百度坐标转换</title>
    <style type="text/css">
        body{
            margin: 0;
            overflow: hidden;
            background: #fff;
        }
        #map{
            position: relative;
            height: 553px;
            border:1px solid #3473b7;
        }
        #mousePositionDiv{
            position: absolute;
            z-index: 99;
            left:0px;
            top:10px;
            font-family: Arial;
            font-size: smaller;
            text-align: left;
            width:400px;
        }
    </style>
    <script src = '../libs/SuperMap.Include.js'></script>
    <script src='./js/layer/Baidu.js'></script>
    <script src="./js/BaiduProjection.js"></script>
    <script type ="text/javascript">

        var map,layer,markerlayer;
                ////成都 天府五街 中国银行 百度bd09ll(104.074635,30.542015)
                var point = new SuperMap.Geometry.Point(104.074635,30.542015);

        function init(){
            map = new SuperMap.Map("map", { controls: [
                new SuperMap.Control.Attribution(),
                new SuperMap.Control.ScaleLine(),
                new SuperMap.Control.Zoom(),
                new SuperMap.Control.Navigation({
                    dragPanOptions: {
                        enableKinetic: true
                    }
                })],
                units: "m"
            });
            //基于SuperMap对百度地图进行了支持与扩展，需要额外引入Baidu.js脚本;
            //脚本位于js/layer/Baidu.js;  2631943.4555396712 1873537.4100395523 173512.06593463058
            layer = new SuperMap.Layer.Baidu();
            markerlayer = new  SuperMap.Layer.Markers("markerLayer");



            map.addLayers([markerlayer,layer]);
            //调用SuperMap.BaiduProjection.convertLL2MC 将bd09ll转为bd09mc
            point = SuperMap.Projection.transform(point,"EPSG:bd09ll","EPSG:bd09mc");

            map.setCenter(new SuperMap.LonLat(point.x,point.y),1);

            //添加一个marker
            addMarker();
            map.events.on({"mousemove":getMousePosition});
            setposition();
            addHandler(window,"resize",setposition);
        }

        //添加marker
        function addMarker(){
            var size = new SuperMap.Size(44,33);
            var offset = new SuperMap.Pixel(-(size.w/2), -size.h);
            var icon = new SuperMap.Icon('../theme/images/marker.png', size, offset);
            markerlayer.addMarker(new SuperMap.Marker(new SuperMap.LonLat(point.x,point.y),icon,offset));
        }

        //通过鼠标屏幕坐标 计算bdo9mc 并将其转成bd09ll
        function getMousePosition(e)
        {
            //调用getLonLatFromPixel将像素坐标转成当前bd9ll坐标
            var bd09mc_lonlat = map.getLonLatFromPixel(new SuperMap.Pixel(e.xy.x,e.xy.y));

            var point1 = new SuperMap.Geometry.Point(bd09mc_lonlat.lon,bd09mc_lonlat.lat);

            //通过调用SuperMap.BaiduProjection.convertMC2LL 将bdo9mc转成bd09ll（即百度 米 转 度）
           // var bd09ll_lonlat = SuperMap.BaiduProjection.convertMC2LL(bd09mc_lonlat);
            var lonlat2 = SuperMap.Projection.transform(point1,"EPSG:bd09mc","EPSG:bd09ll");


            var newHtml="地图坐标转换：像素坐标 bd09mc坐标 bd09ll坐标<br>  鼠标像素坐标："  + "x="+Math.floor(e.clientX)+"，"+"y="+Math.floor(e.clientY) +
                    "<br>bd09mc坐标："+ "lon="+ bd09mc_lonlat.lon + "，" + "lat="+ bd09mc_lonlat.lat +
                    "<br>bd09ll坐标："+ "lon="+ lonlat2.x.toFixed(8) + "，" + "lat="+ lonlat2.y.toFixed(8);
            document.getElementById("mousePositionDiv").innerHTML=newHtml;
        }

        function addHandler(element,type,handler){
            if(element.addEventListener){
                element.addEventListener(type,handler,false);
            }else if(element.attachEvent){
                element.attachEvent("on"+type,handler);
            } else{
                element["on"+type] =handler;
            }
        }
        function setposition(){
            var width= map.getSize().w;
            document.getElementById("mousePositionDiv").style.left=width/2-160+"px" ;
        }
    </script>
</head>
<body onLoad = "init()">
<div id='mousePositionDiv' class='smCustomControlMousePosition'></div>
<div id = "map"></div>
</body>
</html>